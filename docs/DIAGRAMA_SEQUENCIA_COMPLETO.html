<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama de Sequência - Sistema Finanza</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 2px solid #3498db;
            margin-top: 40px;
        }
        .diagram-visual {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
            min-height: 600px;
            overflow-x: auto;
        }
        .visual-diagram {
            font-family: 'Courier New', monospace;
            line-height: 1.4;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            white-space: pre-wrap;
            overflow-x: auto;
            font-size: 11px;
        }
        .description {
            font-style: italic;
            color: #555;
            margin: 10px 0;
            padding: 10px;
            background: #f9f9f9;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        .legend {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .legend h3 {
            color: #34495e;
            margin-top: 0;
        }
        .legend-item {
            display: inline-block;
            margin: 5px 10px;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            border: 2px solid;
        }
        .user { background: #e3f2fd; border-color: #1976d2; }
        .service { background: #e8f5e8; border-color: #2e7d32; }
        .database { background: #fff8e1; border-color: #f9a825; }
        .sync { background: #f3e5f5; border-color: #7b1fa2; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔄 Diagrama de Sequência - Sistema Finanza</h1>
        <p><strong>Fluxos de Interação - Mobile (Android) + Desktop (Java)</strong></p>
        
        <h2>1. Autenticação de Usuário</h2>
        <div class="description">
            <strong>Descrição:</strong> Fluxo completo de autenticação mostrando validação de credenciais, 
            geração de token de sessão e inicialização da sincronização automática após login bem-sucedido.
        </div>
        <div class="diagram-visual">
            <div class="visual-diagram">
╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                            CENÁRIO 1: AUTENTICAÇÃO DE USUÁRIO                                                                                          ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

   👤 Usuário       📱 Mobile App     🔐 AuthService     🗄️ UsuarioDAO       🗃️ MySQL         🔄 SyncService
       │                 │                 │                 │                 │                 │
       │ informa         │                 │                 │                 │                 │
       │ email/senha     │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │
       │                 │ ◄─ activate ───►│                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ login(email,    │                 │                 │                 │
       │                 │ senha)          │                 │                 │                 │
       │                 ├────────────────►│                 │                 │                 │
       │                 │                 │ ◄─ activate ───►│                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │                 │ buscarPorEmail  │                 │                 │
       │                 │                 │ (email)         │                 │                 │
       │                 │                 ├────────────────►│                 │                 │
       │                 │                 │                 │ ◄─ activate ───►│                 │
       │                 │                 │                 │                 │                 │
       │                 │                 │                 │ SELECT * FROM   │                 │
       │                 │                 │                 │ USUARIO WHERE   │                 │
       │                 │                 │                 │ email = ?       │                 │
       │                 │                 │                 ├────────────────►│                 │
       │                 │                 │                 │                 │ ◄─ activate ───►│
       │                 │                 │                 │                 │                 │
       │                 │                 │                 │ dados usuário   │                 │
       │                 │                 │                 │◄────────────────┤                 │
       │                 │                 │                 │ ─ deactivate ──►│                 │
       │                 │                 │                 │                 │                 │
       │                 │                 │ Usuario         │                 │                 │
       │                 │                 │ encontrado      │                 │                 │
       │                 │                 │◄────────────────┤                 │                 │
       │                 │                 │                 │ ─ deactivate ──►│                 │
       │                 │                 │                 │                 │                 │
       │                 │                 │ validarSenha    │                 │                 │
       │                 │                 │ (senha,         │                 │                 │
       │                 │                 │ senhaHash)      │                 │                 │
       │                 │                 ├─────────────────┤                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │                 │ ┌─── SENHA VÁLIDA? ───┐           │                 │
       │                 │                 │ │                     │           │                 │
       │                 │                 │ │ SIM │         │ NÃO │           │                 │
       │                 │                 │ │     │         │     │           │                 │
       │                 │                 │ │ gerarToken    │     │           │                 │
       │                 │                 │ │ (usuario)     │     │           │                 │
       │                 │                 │ ├─────┤         │     │           │                 │
       │                 │                 │ │     │         │     │           │                 │
       │                 │                 │ │ criarSessao   │     │           │                 │
       │                 │                 │ │ (usuario)     │     │           │                 │
       │                 │                 │ ├─────┤         │     │           │                 │
       │                 │                 │ │     │         │     │           │                 │
       │                 │ Login sucesso   │ │     │         │ Erro│           │                 │
       │                 │ + token         │ │     │         │ auth│           │                 │
       │                 │◄────────────────┼─┴─────┘         │     │           │                 │
       │                 │                 │                 │     │           │                 │
       │                 │ iniciarSincroni │                 │     │           │                 │
       │                 │ zacaoAutomatica │                 │     │           │                 │
       │                 │ ()              │                 │     │           │                 │
       │                 ├─────────────────┼─────────────────┼─────┼───────────┼────────────────►│
       │                 │                 │                 │     │           │                 │ ◄─ activate ──►
       │                 │                 │                 │     │           │                 │
       │                 │ Sincronização   │                 │     │           │                 │
       │                 │ iniciada        │                 │     │           │                 │
       │                 │◄────────────────┼─────────────────┼─────┼───────────┼─────────────────┤
       │                 │                 │                 │     │           │                 │ ─ deactivate ──►
       │                 │                 │                 │     │           │                 │
       │ Redireciona     │                 │                 │     │           │                 │
       │ para Dashboard  │                 │                 │     │           │                 │
       │◄────────────────┼─┐               │                 │     │           │                 │
       │                 │ │               │                 │ Erro│           │                 │
       │                 │ │               │                 │ auth│           │                 │
       │                 │ └───────────────┼─────────────────┼─────┴───────────┤                 │
       │                 │                 │                 │                 │                 │
       │ Exibe mensagem  │                 │                 │                 │                 │
       │ de erro         │                 │                 │                 │                 │
       │◄────────────────┤                 │                 │                 │                 │
       │                 │ ─ deactivate ──►│                 │                 │                 │
       │                 │ ─ deactivate ──►│                 │                 │                 │
       │                 │                 │                 │                 │                 │

Tempo estimado: 2-3 segundos para login completo
            </div>
        </div>
        
        <h2>2. Adicionar Nova Transação (Mobile)</h2>
        <div class="description">
            <strong>Descrição:</strong> Criação de nova transação no aplicativo mobile com persistência local 
            e marcação para sincronização posterior com o servidor.
        </div>
        <div class="diagram-visual">
            <div class="visual-diagram">
╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                        CENÁRIO 2: ADICIONAR NOVA TRANSAÇÃO (MOBILE)                                                                           ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

   👤 Usuário       📱 Mobile App     💰 TransacaoDAO    📱 SQLite Local    🔄 SyncService     📡 SyncData
       │                 │                 │                 │                 │                 │
       │ preenche        │                 │                 │                 │                 │
       │ formulário      │                 │                 │                 │                 │
       │ transação       │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │ clica "Salvar"  │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │
       │                 │ ◄─ activate ───►│                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ validarDados    │                 │                 │                 │
       │                 │ (transacao)     │                 │                 │                 │
       │                 ├─────────────────┤                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ ┌─── DADOS VÁLIDOS? ───┐         │                 │                 │
       │                 │ │                      │         │                 │                 │
       │                 │ │ SIM │          │ NÃO │         │                 │                 │
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │ inserir       │     │         │                 │                 │
       │                 │ │ (transacao)   │     │         │                 │                 │
       │                 │ ├─────┼─────────►│     │         │                 │                 │
       │                 │ │     │          │     │         │ ◄─ activate ───►│                 │
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │     │ INSERT   │     │         │                 │                 │
       │                 │ │     │ INTO     │     │         │                 │                 │
       │                 │ │     │ transacao│     │         │                 │                 │
       │                 │ │     │ VALUES   │     │         │                 │                 │
       │                 │ │     │ (...)    │     │         │                 │                 │
       │                 │ │     ├─────────►│     │         │                 │                 │
       │                 │ │     │          │     │         │ ◄─ activate ───►│                 │
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │     │ Sucesso  │     │         │                 │                 │
       │                 │ │     │ inserção │     │         │                 │                 │
       │                 │ │     │◄─────────┤     │         │                 │                 │
       │                 │ │     │          │     │         │ ─ deactivate ──►│                 │
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │ Transação      │     │         │                 │                 │
       │                 │ │ salva local    │     │         │                 │                 │
       │                 │ │◄────┼──────────┤     │         │                 │                 │
       │                 │ │     │          │     │         │ ─ deactivate ──►│                 │
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │ adicionarPara  │     │         │                 │                 │
       │                 │ │ Sincronizacao  │     │         │                 │                 │
       │                 │ │ (transacao,    │     │         │                 │                 │
       │                 │ │ "CREATE")      │     │         │                 │                 │
       │                 │ ├─────┼──────────┼─────┼─────────┼────────────────►│                 │
       │                 │ │     │          │     │         │                 │ ◄─ activate ───►│
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │     │          │     │         │ criar(tipo:     │                 │
       │                 │ │     │          │     │         │ "TRANSACAO",    │                 │
       │                 │ │     │          │     │         │ acao:"CREATE",  │                 │
       │                 │ │     │          │     │         │ dados:transacao)│                 │
       │                 │ │     │          │     │         ├────────────────►│                 │
       │                 │ │     │          │     │         │                 │ ◄─ activate ───►│
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │     │          │     │         │ Registro sync   │                 │
       │                 │ │     │          │     │         │ criado          │                 │
       │                 │ │     │          │     │         │◄────────────────┤                 │
       │                 │ │     │          │     │         │                 │ ─ deactivate ──►│
       │                 │ │     │          │     │         │                 │                 │
       │                 │ │ Adicionado à   │     │         │                 │                 │
       │                 │ │ fila de sync   │     │         │                 │                 │
       │                 │ │◄────┼──────────┼─────┼─────────┤                 │                 │
       │                 │ │     │          │     │         │ ─ deactivate ──►│                 │
       │                 │ │     │          │     │         │                 │                 │
       │ Transação salva │ │     │          │     │         │                 │                 │
       │ com sucesso     │ │     │          │     │         │                 │                 │
       │◄────────────────┼─┴─────┘          │     │         │                 │                 │
       │                 │                  │     │         │                 │                 │
       │                 │                  │ Erro│         │                 │                 │
       │                 │                  │ val.│         │                 │                 │
       │                 │                  └─────┘         │                 │                 │
       │                 │                        │         │                 │                 │
       │ Exibe erros     │                        │         │                 │                 │
       │ de validação    │                        │         │                 │                 │
       │◄────────────────┤                        │         │                 │                 │
       │                 │ ─ deactivate ──────────┘         │                 │                 │
       │                 │                                  │                 │                 │

Tempo estimado: < 1 segundo para persistência local
            </div>
        </div>
        
        <h2>3. Processo de Sincronização</h2>
        <div class="description">
            <strong>Descrição:</strong> Sincronização automática entre dispositivo mobile e servidor, 
            incluindo detecção e resolução de conflitos de dados.
        </div>
        <div class="diagram-visual">
            <div class="visual-diagram">
╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                         CENÁRIO 3: PROCESSO DE SINCRONIZAÇÃO                                                                            ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

   📱 Mobile App    🔄 SyncService    📡 SyncDataDAO     🌐 NetworkMgr      🖥️ Servidor       ⚖️ ConflictRes
       │                 │                 │                 │                 │                 │
       │ iniciarSincroni │                 │                 │                 │                 │
       │ zacao()         │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │
       │                 │ ◄─ activate ───►│                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ verificarConec  │                 │                 │                 │
       │                 │ tividade()      │                 │                 │                 │
       │                 ├─────────────────┼─────────────────┼────────────────►│                 │
       │                 │                 │                 │ ◄─ activate ───►│                 │
       │                 │                 │                 │                 │                 │
       │                 │ Conectividade   │                 │                 │                 │
       │                 │ OK              │                 │                 │                 │
       │                 │◄────────────────┼─────────────────┼─────────────────┤                 │
       │                 │                 │                 │ ─ deactivate ──►│                 │
       │                 │                 │                 │                 │                 │
       │                 │ obterDados      │                 │                 │                 │
       │                 │ Pendentes()     │                 │                 │                 │
       │                 ├────────────────►│                 │                 │                 │
       │                 │                 │ ◄─ activate ───►│                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ Lista registros │                 │                 │                 │
       │                 │ para sync       │                 │                 │                 │
       │                 │◄────────────────┤                 │                 │                 │
       │                 │                 │ ─ deactivate ──►│                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ ┌─── LOOP: PARA CADA REGISTRO ────┐                │                 │
       │                 │ │                                 │                │                 │
       │                 │ │ enviarDados    │                │                │                 │
       │                 │ │ (dadosLocal)   │                │                │                 │
       │                 │ ├─────────────────┼─────────────────┼──────────────►│                 │
       │                 │ │                │                │                │ ◄─ activate ───►│
       │                 │ │                │                │                │                 │
       │                 │ │ ┌─── CONFLITO? ───┐             │                │                 │
       │                 │ │ │                  │             │                │                 │
       │                 │ │ │ NÃO │      │ SIM │             │                │                 │
       │                 │ │ │     │      │     │             │                │                 │
       │                 │ │ │Confirmação │Conflito+        │                │                 │
       │                 │ │ │recebimento │dadosServidor    │                │                 │
       │                 │ │ │◄───────────┼─────┼───────────┤                │                 │
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ │marcarComo  │     │resolver   │                │                 │
       │                 │ │ │Sincronizado│     │Conflito   │                │                 │
       │                 │ │ │(uuid)      │     │(dadosL,   │                │                 │
       │                 │ │ ├────────────┼─────┼───────────┼────────────────┼────────────────►│
       │                 │ │ │            │     │dadosS)    │                │                 │ ◄─ activate ──►
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ │            │     │ aplicar   │                │                 │
       │                 │ │ │            │     │ Estrategia│                │                 │
       │                 │ │ │            │     │ Resolucao │                │                 │
       │                 │ │ │            │     ├───────────┤                │                 │
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ │            │     │ Dados     │                │                 │
       │                 │ │ │            │     │ resolvidos│                │                 │
       │                 │ │ │            │     │◄──────────┤                │                 │ ─ deactivate ──►
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ │            │     │reenviar   │                │                 │
       │                 │ │ │            │     │Dados      │                │                 │
       │                 │ │ │            │     │(dadosRes) │                │                 │
       │                 │ │ │            │     ├───────────┼────────────────┼────────────────►│
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ │            │     │Confirmação│                │                 │
       │                 │ │ │            │     │final      │                │                 │
       │                 │ │ │            │     │◄──────────┼────────────────┼─────────────────┤
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ │            │     │marcarComo │                │                 │
       │                 │ │ │            │     │Sincroniz  │                │                 │
       │                 │ │ │            │     │(uuid)     │                │                 │
       │                 │ │ │            │     ├───────────┤                │                 │
       │                 │ │ │            │     │           │                │                 │
       │                 │ │ └────────────┴─────┴───────────┤                │ ─ deactivate ──►│
       │                 │ │                                 │                │                 │
       │                 │ └─────────── FIM LOOP ───────────┘                │                 │
       │                 │                                                    │                 │
       │ Sincronização   │                                                    │                 │
       │ concluída       │                                                    │                 │
       │◄────────────────┤                                                    │                 │
       │                 │ ─ deactivate ───────────────────────────────────────┘                 │
       │                 │                                                                        │

Estratégias de Resolução de Conflitos:
1. LOCAL_WINS: Dados locais sobrescrevem servidor
2. REMOTE_WINS: Dados servidor sobrescrevem local
3. MERGE: Combinação inteligente dos dados
            </div>
        </div>
        
        <h2>4. Geração de Relatório (Desktop)</h2>
        <div class="description">
            <strong>Descrição:</strong> Processo completo de geração de relatório financeiro na aplicação desktop, 
            incluindo consulta aos dados, processamento e exportação em diferentes formatos.
        </div>
        <div class="diagram-visual">
            <div class="visual-diagram">
╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                       CENÁRIO 4: GERAÇÃO DE RELATÓRIO (DESKTOP)                                                                         ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

   👤 Admin Desktop 🖥️ Desktop UI    📊 RelatorioSvc   💰 TransacaoDAO    🗃️ MySQL         📄 ExportService   📁 FileSystem
       │                 │                 │                 │                 │                 │                 │
       │ acessa tela     │                 │                 │                 │                 │                 │
       │ relatórios      │                 │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │ carregarPara    │                 │                 │                 │                 │
       │                 │ metros()        │                 │                 │                 │                 │
       │                 ├─────────────────┤                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │ Exibe formulário│                 │                 │                 │                 │                 │
       │ de relatório    │                 │                 │                 │                 │                 │
       │◄────────────────┤                 │                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │ define período  │                 │                 │                 │                 │                 │
       │ e filtros       │                 │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │ clica "Gerar    │                 │                 │                 │                 │                 │
       │ Relatório"      │                 │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │                 │
       │                 │ ◄─ activate ───►│                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │ gerarRelatorio  │                 │                 │                 │                 │
       │                 │ (parametros)    │                 │                 │                 │                 │
       │                 ├────────────────►│                 │                 │                 │                 │
       │                 │                 │ ◄─ activate ───►│                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │ consultarTrans  │                 │                 │                 │
       │                 │                 │ acoes(filtros)  │                 │                 │                 │
       │                 │                 ├────────────────►│                 │                 │                 │
       │                 │                 │                 │ ◄─ activate ───►│                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │                 │ SELECT com      │                 │                 │
       │                 │                 │                 │ JOINs e filtros │                 │                 │
       │                 │                 │                 ├────────────────►│                 │                 │
       │                 │                 │                 │                 │ ◄─ activate ───►│                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │                 │ Dados das       │                 │                 │
       │                 │                 │                 │ transações      │                 │                 │
       │                 │                 │                 │◄────────────────┤                 │                 │
       │                 │                 │                 │                 │ ─ deactivate ──►│                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │ Lista de        │                 │                 │                 │
       │                 │                 │ transações      │                 │                 │                 │
       │                 │                 │◄────────────────┤                 │                 │                 │
       │                 │                 │                 │ ─ deactivate ──►│                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │ processarDados  │                 │                 │                 │
       │                 │                 │ (transacoes)    │                 │                 │                 │
       │                 │                 ├─────────────────┤                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │ calcularTotais  │                 │                 │                 │
       │                 │                 │ ()              │                 │                 │                 │
       │                 │                 ├─────────────────┤                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │ agruparPor      │                 │                 │                 │
       │                 │                 │ Categoria()     │                 │                 │                 │
       │                 │                 ├─────────────────┤                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │ exportar(dados, │                 │                 │                 │
       │                 │                 │ formato)        │                 │                 │                 │
       │                 │                 ├─────────────────┼─────────────────┼─────────────────┼────────────────►│
       │                 │                 │                 │                 │                 │                 │ ◄─ activate ──►
       │                 │                 │                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │ ┌─── FORMATO? ──┐
       │                 │                 │                 │                 │                 │ │               │
       │                 │                 │                 │                 │                 │ │PDF│Excel│CSV │
       │                 │                 │                 │                 │                 │ │   │     │    │
       │                 │                 │                 │                 │                 │ │gerar │gerar│gerar│
       │                 │                 │                 │                 │                 │ │PDF() │Excel│CSV()│
       │                 │                 │                 │                 │                 │ ├──┼───┤│────┤│───┤
       │                 │                 │                 │                 │                 │ │  │   ││    ││   │
       │                 │                 │                 │                 │                 │ │salvar│salvar│salvar│
       │                 │                 │                 │                 │                 │ │Arquivo│Arquivo│Arquivo│
       │                 │                 │                 │                 │                 │ │(pdf, │(excel,│(csv,│
       │                 │                 │                 │                 │                 │ │caminho│caminho│caminho│
       │                 │                 │                 │                 │                 │ ├──────┼───────┼──────┼────►
       │                 │                 │                 │                 │                 │ │      │       │      │     │ ◄─ activate ──►
       │                 │                 │                 │                 │                 │ │      │       │      │     │
       │                 │                 │                 │                 │                 │ │Arquivo salvo  │      │     │
       │                 │                 │                 │                 │                 │ │◄─────┼───────┼──────┼─────│
       │                 │                 │                 │                 │                 │ └──────┴───────┴──────┴─────│ ─ deactivate ──►
       │                 │                 │                 │                 │                 │                             │
       │                 │                 │ Caminho do      │                 │                 │                             │
       │                 │                 │ arquivo         │                 │                 │                             │
       │                 │                 │◄────────────────┼─────────────────┼─────────────────┼─────────────────────────────┘
       │                 │                 │                 │                 │                 │ ─ deactivate ───────────────►
       │                 │                 │                 │                 │                 │
       │                 │                 │ criarRegistro   │                 │                 │
       │                 │                 │ Relatorio       │                 │                 │
       │                 │                 │ (params,caminho)│                 │                 │
       │                 │                 ├─────────────────┤                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ Relatório       │                 │                 │                 │
       │                 │ gerado com      │                 │                 │                 │
       │                 │ sucesso         │                 │                 │                 │
       │                 │◄────────────────┤                 │                 │                 │
       │                 │                 │ ─ deactivate ──►│                 │                 │
       │                 │                 │                 │                 │                 │
       │ Exibe link      │                 │                 │                 │                 │
       │ para download   │                 │                 │                 │                 │
       │◄────────────────┤                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │ clica para      │                 │                 │                 │                 │
       │ baixar          │                 │                 │                 │                 │
       ├────────────────►│                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │
       │                 │ abrirArquivo    │                 │                 │                 │
       │                 │ (caminho)       │                 │                 │                 │
       │                 ├─────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────►│
       │                 │                 │                 │                 │                 │                 │
       │ Download do     │                 │                 │                 │                 │                 │
       │ relatório       │                 │                 │                 │                 │                 │
       │◄────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┤
       │                 │                 │                 │                 │                 │                 │
       │                 │ ─ deactivate ──►│                 │                 │                 │                 │
       │                 │                 │                 │                 │                 │                 │

Tempo estimado: 5-15 segundos dependendo do volume de dados
            </div>
        </div>
        
        <div class="legend">
            <h3>🎨 Legenda dos Participantes:</h3>
            <div class="legend-item user">👤 Usuários e Interfaces</div>
            <div class="legend-item service">🔧 Serviços e Lógica de Negócio</div>
            <div class="legend-item database">💾 Persistência e Dados</div>
            <div class="legend-item sync">🔄 Sincronização e Rede</div>
        </div>
        
        <div class="legend">
            <h3>📊 Análise dos Fluxos:</h3>
            <ul>
                <li><strong>Autenticação:</strong> 2-3 segundos para login completo</li>
                <li><strong>Transação Mobile:</strong> Persistência local instantânea + sync em background</li>
                <li><strong>Sincronização:</strong> Automática a cada 30 segundos ou manual</li>
                <li><strong>Relatórios:</strong> 5-15 segundos dependendo do volume de dados</li>
                <li><strong>Resolução de Conflitos:</strong> 3 estratégias (local, remoto, merge)</li>
            </ul>
        </div>
        
        <div class="legend">
            <h3>🎯 Padrões de Design Identificados:</h3>
            <ul>
                <li><strong>Command Pattern:</strong> Operações offline encapsuladas como comandos</li>
                <li><strong>Observer Pattern:</strong> Notificações de mudanças de estado</li>
                <li><strong>Strategy Pattern:</strong> Múltiplas estratégias de resolução de conflitos</li>
                <li><strong>Chain of Responsibility:</strong> Pipeline de validações e processamento</li>
                <li><strong>Repository Pattern:</strong> Abstração da camada de persistência</li>
            </ul>
        </div>
        
        <div class="legend">
            <h3>🛡️ Tratamento de Erros:</h3>
            <ul>
                <li><strong>Autenticação:</strong> Validação de credenciais + bloqueio após tentativas</li>
                <li><strong>Transações:</strong> Validações de negócio + rollback automático</li>
                <li><strong>Sincronização:</strong> Retry automático + queue de dados offline</li>
                <li><strong>Relatórios:</strong> Timeout configurável + cache de resultados</li>
            </ul>
        </div>
    </div>
</body>
</html>