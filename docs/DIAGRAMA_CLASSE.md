# 7. DIAGRAMA DE CLASSE - FINANZA

## üìã Vis√£o Geral

O diagrama de classes do sistema Finanza apresenta a estrutura orientada a objetos completa, mostrando as principais entidades do dom√≠nio, seus atributos, m√©todos e relacionamentos. O modelo suporta tanto a aplica√ß√£o mobile Android quanto a aplica√ß√£o desktop Java.

---

## üèóÔ∏è Arquitetura de Classes

```mermaid
classDiagram
    %% Classes Principais do Dom√≠nio
    class Usuario {
        -String uuid
        -String nome
        -String email
        -String senhaHash
        -Date dataCriacao
        -Date ultimoLogin
        -boolean ativo
        -String configuracoes
        +Usuario()
        +String getUuid()
        +void setUuid(String uuid)
        +String getNome()
        +void setNome(String nome)
        +String getEmail()
        +void setEmail(String email)
        +boolean validarSenha(String senha)
        +void criptografarSenha(String senha)
        +boolean isAtivo()
        +void ativar()
        +void desativar()
        +Date getUltimoLogin()
        +void atualizarUltimoLogin()
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    class Conta {
        -String uuid
        -String nome
        -String tipo
        -BigDecimal saldo
        -String banco
        -String agencia
        -String numero
        -boolean ativa
        -Date dataCriacao
        -String uuidUsuario
        +Conta()
        +Conta(String nome, String tipo, String uuidUsuario)
        +String getUuid()
        +void setUuid(String uuid)
        +String getNome()
        +void setNome(String nome)
        +String getTipo()
        +void setTipo(String tipo)
        +BigDecimal getSaldo()
        +void setSaldo(BigDecimal saldo)
        +void adicionarValor(BigDecimal valor)
        +void subtrairValor(BigDecimal valor)
        +boolean isAtiva()
        +void ativar()
        +void desativar()
        +String getUuidUsuario()
        +void setUuidUsuario(String uuidUsuario)
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    class Categoria {
        -String uuid
        -String nome
        -String tipo
        -String cor
        -String icone
        -boolean ativa
        -Date dataCriacao
        -String uuidUsuario
        +Categoria()
        +Categoria(String nome, String tipo, String uuidUsuario)
        +String getUuid()
        +void setUuid(String uuid)
        +String getNome()
        +void setNome(String nome)
        +String getTipo()
        +void setTipo(String tipo)
        +String getCor()
        +void setCor(String cor)
        +String getIcone()
        +void setIcone(String icone)
        +boolean isAtiva()
        +void ativar()
        +void desativar()
        +String getUuidUsuario()
        +void setUuidUsuario(String uuidUsuario)
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    class Transacao {
        -String uuid
        -BigDecimal valor
        -String descricao
        -Date data
        -String tipo
        -String status
        -String observacoes
        -Date dataModificacao
        -String uuidConta
        -String uuidCategoria
        -String uuidUsuario
        +Transacao()
        +Transacao(BigDecimal valor, String tipo, String uuidConta, String uuidCategoria, String uuidUsuario)
        +String getUuid()
        +void setUuid(String uuid)
        +BigDecimal getValor()
        +void setValor(BigDecimal valor)
        +String getDescricao()
        +void setDescricao(String descricao)
        +Date getData()
        +void setData(Date data)
        +String getTipo()
        +void setTipo(String tipo)
        +String getStatus()
        +void setStatus(String status)
        +void confirmar()
        +void cancelar()
        +void estornar()
        +String getUuidConta()
        +void setUuidConta(String uuidConta)
        +String getUuidCategoria()
        +void setUuidCategoria(String uuidCategoria)
        +String getUuidUsuario()
        +void setUuidUsuario(String uuidUsuario)
        +boolean isReceita()
        +boolean isDespesa()
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    %% Classes de Sincroniza√ß√£o
    class SyncData {
        -String uuid
        -String tipoEntidade
        -String uuidEntidade
        -String acao
        -Date timestamp
        -String dadosJson
        -boolean sincronizado
        -String uuidUsuario
        +SyncData()
        +SyncData(String tipoEntidade, String uuidEntidade, String acao, String uuidUsuario)
        +String getUuid()
        +void setUuid(String uuid)
        +String getTipoEntidade()
        +void setTipoEntidade(String tipoEntidade)
        +String getUuidEntidade()
        +void setUuidEntidade(String uuidEntidade)
        +String getAcao()
        +void setAcao(String acao)
        +Date getTimestamp()
        +void setTimestamp(Date timestamp)
        +String getDadosJson()
        +void setDadosJson(String dadosJson)
        +boolean isSincronizado()
        +void marcarComoSincronizado()
        +void marcarComoNaoSincronizado()
        +String getUuidUsuario()
        +void setUuidUsuario(String uuidUsuario)
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    class ConflictResolution {
        -String uuid
        -String tipoConflito
        -String uuidEntidade
        -String dadosServidor
        -String dadosCliente
        -String resolucao
        -Date timestampConflito
        -Date timestampResolucao
        -String uuidUsuario
        +ConflictResolution()
        +String getUuid()
        +void setUuid(String uuid)
        +String getTipoConflito()
        +void setTipoConflito(String tipoConflito)
        +String getUuidEntidade()
        +void setUuidEntidade(String uuidEntidade)
        +String getDadosServidor()
        +void setDadosServidor(String dadosServidor)
        +String getDadosCliente()
        +void setDadosCliente(String dadosCliente)
        +String getResolucao()
        +void setResolucao(String resolucao)
        +Date getTimestampConflito()
        +void setTimestampConflito(Date timestampConflito)
        +Date getTimestampResolucao()
        +void setTimestampResolucao(Date timestampResolucao)
        +void resolverConflito(String estrategia)
        +boolean isResolvido()
        +String getUuidUsuario()
        +void setUuidUsuario(String uuidUsuario)
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    %% Classes de Relat√≥rio
    class Relatorio {
        -String uuid
        -String tipo
        -String titulo
        -Date dataInicio
        -Date dataFim
        -String parametros
        -String formato
        -Date dataGeracao
        -String caminhoArquivo
        -String uuidUsuario
        +Relatorio()
        +Relatorio(String tipo, String titulo, Date dataInicio, Date dataFim, String uuidUsuario)
        +String getUuid()
        +void setUuid(String uuid)
        +String getTipo()
        +void setTipo(String tipo)
        +String getTitulo()
        +void setTitulo(String titulo)
        +Date getDataInicio()
        +void setDataInicio(Date dataInicio)
        +Date getDataFim()
        +void setDataFim(Date dataFim)
        +String getParametros()
        +void setParametros(String parametros)
        +String getFormato()
        +void setFormato(String formato)
        +Date getDataGeracao()
        +void setDataGeracao(Date dataGeracao)
        +String getCaminhoArquivo()
        +void setCaminhoArquivo(String caminhoArquivo)
        +void gerar()
        +void exportar(String formato)
        +boolean isGerado()
        +String getUuidUsuario()
        +void setUuidUsuario(String uuidUsuario)
        +String toString()
        +boolean equals(Object obj)
        +int hashCode()
    }
    
    %% Classes de Controle/Servi√ßo
    class AuthService {
        -static AuthService instance
        -SessionManager sessionManager
        +static AuthService getInstance()
        +Usuario login(String email, String senha)
        +boolean logout(String uuidUsuario)
        +Usuario registrar(String nome, String email, String senha)
        +boolean recuperarSenha(String email)
        +boolean alterarSenha(String uuidUsuario, String senhaAtual, String novaSenha)
        +boolean isUsuarioLogado(String uuidUsuario)
        +Session getSession(String uuidUsuario)
        +boolean validarToken(String token)
        +String gerarToken(Usuario usuario)
    }
    
    class SyncService {
        -static SyncService instance
        -Queue~SyncData~ filaSincronizacao
        -boolean sincronizandoAtivo
        +static SyncService getInstance()
        +void adicionarParaSincronizacao(SyncData dados)
        +void sincronizarTudo(String uuidUsuario)
        +void sincronizarEntidade(String tipoEntidade, String uuidEntidade)
        +List~ConflictResolution~ detectarConflitos(String uuidUsuario)
        +void resolverConflito(ConflictResolution conflito, String estrategia)
        +boolean isSincronizandoAtivo()
        +void iniciarSincronizacaoAutomatica()
        +void pararSincronizacaoAutomatica()
        +SyncStatus getStatusSincronizacao(String uuidUsuario)
    }
    
    class DatabaseManager {
        -static DatabaseManager instance
        -Connection connection
        -String connectionString
        +static DatabaseManager getInstance()
        +Connection getConnection()
        +void closeConnection()
        +boolean executarQuery(String sql, Object[] parametros)
        +ResultSet executarSelect(String sql, Object[] parametros)
        +boolean testarConexao()
        +void configurarPool()
        +void backupDatabase(String caminho)
        +void restoreDatabase(String caminho)
    }
    
    %% Classes DAO (Data Access Object)
    class UsuarioDAO {
        -DatabaseManager dbManager
        +UsuarioDAO()
        +boolean inserir(Usuario usuario)
        +Usuario buscarPorUuid(String uuid)
        +Usuario buscarPorEmail(String email)
        +List~Usuario~ listarTodos()
        +boolean atualizar(Usuario usuario)
        +boolean excluir(String uuid)
        +List~Usuario~ buscarPorNome(String nome)
        +boolean emailJaExiste(String email)
    }
    
    class ContaDAO {
        -DatabaseManager dbManager
        +ContaDAO()
        +boolean inserir(Conta conta)
        +Conta buscarPorUuid(String uuid)
        +List~Conta~ listarPorUsuario(String uuidUsuario)
        +boolean atualizar(Conta conta)
        +boolean excluir(String uuid)
        +BigDecimal calcularSaldoTotal(String uuidUsuario)
        +List~Conta~ buscarPorTipo(String tipo, String uuidUsuario)
    }
    
    class CategoriaDAO {
        -DatabaseManager dbManager
        +CategoriaDAO()
        +boolean inserir(Categoria categoria)
        +Categoria buscarPorUuid(String uuid)
        +List~Categoria~ listarPorUsuario(String uuidUsuario)
        +List~Categoria~ listarPorTipo(String tipo, String uuidUsuario)
        +boolean atualizar(Categoria categoria)
        +boolean excluir(String uuid)
        +List~Categoria~ buscarPorNome(String nome, String uuidUsuario)
    }
    
    class TransacaoDAO {
        -DatabaseManager dbManager
        +TransacaoDAO()
        +boolean inserir(Transacao transacao)
        +Transacao buscarPorUuid(String uuid)
        +List~Transacao~ listarPorUsuario(String uuidUsuario)
        +List~Transacao~ listarPorPeriodo(Date inicio, Date fim, String uuidUsuario)
        +List~Transacao~ listarPorConta(String uuidConta)
        +List~Transacao~ listarPorCategoria(String uuidCategoria)
        +boolean atualizar(Transacao transacao)
        +boolean excluir(String uuid)
        +BigDecimal somarPorTipo(String tipo, String uuidUsuario)
        +BigDecimal somarPorCategoria(String uuidCategoria)
        +List~Transacao~ buscarPorDescricao(String descricao, String uuidUsuario)
    }
    
    %% Relacionamentos
    Usuario ||--o{ Conta : possui
    Usuario ||--o{ Categoria : cria
    Usuario ||--o{ Transacao : realiza
    Usuario ||--o{ SyncData : gera
    Usuario ||--o{ ConflictResolution : possui
    Usuario ||--o{ Relatorio : solicita
    
    Conta ||--o{ Transacao : cont√©m
    Categoria ||--o{ Transacao : classifica
    
    Transacao ||--o| SyncData : sincroniza
    
    AuthService --> Usuario : autentica
    AuthService --> SessionManager : utiliza
    
    SyncService --> SyncData : gerencia
    SyncService --> ConflictResolution : resolve
    
    UsuarioDAO --> Usuario : persiste
    ContaDAO --> Conta : persiste
    CategoriaDAO --> Categoria : persiste
    TransacaoDAO --> Transacao : persiste
    
    UsuarioDAO --> DatabaseManager : utiliza
    ContaDAO --> DatabaseManager : utiliza
    CategoriaDAO --> DatabaseManager : utiliza
    TransacaoDAO --> DatabaseManager : utiliza
    
    SyncService --> TransacaoDAO : acessa
    SyncService --> ContaDAO : acessa
    SyncService --> CategoriaDAO : acessa
    
    AuthService --> UsuarioDAO : acessa
```

---

## üìä Detalhamento das Classes Principais

### **üîê Classe Usuario**
**Responsabilidade:** Representar usu√°rios do sistema
- **Atributos Principais:**
  - `uuid`: Identificador √∫nico universal
  - `email`: Credencial de login √∫nica
  - `senhaHash`: Senha criptografada SHA-256
  - `ativo`: Status da conta
- **M√©todos Principais:**
  - `validarSenha()`: Verifica credenciais
  - `criptografarSenha()`: Aplica hash de seguran√ßa
  - `atualizarUltimoLogin()`: Registra acesso

### **üí≥ Classe Conta**
**Responsabilidade:** Gerenciar contas banc√°rias e carteiras
- **Atributos Principais:**
  - `saldo`: Valor atual da conta
  - `tipo`: Conta corrente, poupan√ßa, cart√£o, etc.
  - `banco`: Institui√ß√£o financeira
- **M√©todos Principais:**
  - `adicionarValor()`: Incrementa saldo
  - `subtrairValor()`: Decrementa saldo
  - `isAtiva()`: Verifica status

### **üè∑Ô∏è Classe Categoria**
**Responsabilidade:** Organizar transa√ß√µes por categoria
- **Atributos Principais:**
  - `tipo`: Receita ou despesa
  - `cor`: Identifica√ß√£o visual
  - `icone`: Representa√ß√£o gr√°fica
- **M√©todos Principais:**
  - `ativar()/desativar()`: Controle de status

### **üí∞ Classe Transacao**
**Responsabilidade:** Representar movimenta√ß√µes financeiras
- **Atributos Principais:**
  - `valor`: Quantia da transa√ß√£o
  - `tipo`: Receita ou despesa
  - `status`: Confirmada, pendente, cancelada
- **M√©todos Principais:**
  - `confirmar()`: Efetiva transa√ß√£o
  - `estornar()`: Reverte transa√ß√£o
  - `isReceita()/isDespesa()`: Verifica√ß√£o de tipo

---

## üîÑ Classes de Sincroniza√ß√£o

### **üì° Classe SyncData**
**Responsabilidade:** Controlar dados de sincroniza√ß√£o
- **Atributos Principais:**
  - `tipoEntidade`: Tipo do objeto (Usuario, Conta, etc.)
  - `acao`: Criar, atualizar, excluir
  - `timestamp`: Momento da modifica√ß√£o
- **M√©todos Principais:**
  - `marcarComoSincronizado()`: Confirma sincroniza√ß√£o

### **‚öñÔ∏è Classe ConflictResolution**
**Responsabilidade:** Resolver conflitos de sincroniza√ß√£o
- **Atributos Principais:**
  - `dadosServidor`: Vers√£o do servidor
  - `dadosCliente`: Vers√£o do cliente
  - `resolucao`: Estrat√©gia aplicada
- **M√©todos Principais:**
  - `resolverConflito()`: Aplica estrat√©gia de resolu√ß√£o

---

## üõ†Ô∏è Classes de Servi√ßo

### **üîê Classe AuthService (Singleton)**
**Responsabilidade:** Gerenciar autentica√ß√£o e seguran√ßa
- **Padr√£o:** Singleton para inst√¢ncia √∫nica
- **Funcionalidades:**
  - Login/logout de usu√°rios
  - Gera√ß√£o e valida√ß√£o de tokens
  - Recupera√ß√£o de senhas

### **üîÑ Classe SyncService (Singleton)**
**Responsabilidade:** Coordenar sincroniza√ß√£o
- **Padr√£o:** Singleton para controle centralizado
- **Funcionalidades:**
  - Fila de sincroniza√ß√£o
  - Detec√ß√£o de conflitos
  - Sincroniza√ß√£o autom√°tica

### **üóÑÔ∏è Classe DatabaseManager (Singleton)**
**Responsabilidade:** Gerenciar conex√µes com banco
- **Padr√£o:** Singleton para pool de conex√µes
- **Funcionalidades:**
  - Controle de conex√µes
  - Backup/restore
  - Pool de conex√µes

---

## üìÅ Classes DAO (Data Access Object)

### **Padr√£o DAO Implementado:**
- **UsuarioDAO**: Persist√™ncia de usu√°rios
- **ContaDAO**: Persist√™ncia de contas
- **CategoriaDAO**: Persist√™ncia de categorias
- **TransacaoDAO**: Persist√™ncia de transa√ß√µes

### **Funcionalidades Comuns:**
- CRUD completo (Create, Read, Update, Delete)
- Consultas espec√≠ficas por crit√©rio
- Valida√ß√µes de integridade

---

## üèóÔ∏è Padr√µes de Design Utilizados

### **1. Singleton**
- `AuthService`: Inst√¢ncia √∫nica de autentica√ß√£o
- `SyncService`: Controle centralizado de sincroniza√ß√£o
- `DatabaseManager`: Pool √∫nico de conex√µes

### **2. DAO (Data Access Object)**
- Separa√ß√£o entre l√≥gica de neg√≥cio e acesso a dados
- Facilita manuten√ß√£o e testes
- Abstrai detalhes do banco de dados

### **3. Repository Pattern**
- Services utilizam DAOs como repositories
- Centraliza l√≥gica de acesso a dados
- Facilita mudan√ßas de persist√™ncia

### **4. Value Object**
- Classes de dom√≠nio s√£o immut√°veis quando poss√≠vel
- Implementam equals() e hashCode()
- Valida√ß√µes no construtor

---

## üîó Relacionamentos e Cardinalidades

### **Relacionamentos Principais:**
- `Usuario 1:N Conta` - Um usu√°rio possui v√°rias contas
- `Usuario 1:N Categoria` - Um usu√°rio cria v√°rias categorias
- `Usuario 1:N Transacao` - Um usu√°rio realiza v√°rias transa√ß√µes
- `Conta 1:N Transacao` - Uma conta cont√©m v√°rias transa√ß√µes
- `Categoria 1:N Transacao` - Uma categoria classifica v√°rias transa√ß√µes

### **Relacionamentos de Sincroniza√ß√£o:**
- `Usuario 1:N SyncData` - Dados de sync por usu√°rio
- `Usuario 1:N ConflictResolution` - Conflitos por usu√°rio
- `Transacao 1:1 SyncData` - Cada transa√ß√£o gera dados de sync

---

## üìà M√©tricas do Diagrama

### **Estat√≠sticas:**
- **Total de Classes:** 13 classes principais
- **Classes de Dom√≠nio:** 7 classes
- **Classes de Servi√ßo:** 3 classes
- **Classes DAO:** 4 classes
- **Relacionamentos:** 15 associa√ß√µes

### **Complexidade:**
- **M√©todos por Classe:** M√©dia de 12 m√©todos
- **Atributos por Classe:** M√©dia de 8 atributos
- **Relacionamentos por Classe:** M√©dia de 3 relacionamentos

---

## üéØ Benef√≠cios da Arquitetura

### **Manutenibilidade:**
- ‚úÖ Separa√ß√£o clara de responsabilidades
- ‚úÖ Baixo acoplamento entre classes
- ‚úÖ Alta coes√£o dentro das classes

### **Escalabilidade:**
- ‚úÖ F√°cil adi√ß√£o de novas entidades
- ‚úÖ Padr√µes consistentes
- ‚úÖ Extensibilidade planejada

### **Testabilidade:**
- ‚úÖ Classes isoladas
- ‚úÖ Depend√™ncias injet√°veis
- ‚úÖ M√©todos unit√°rios

---

**Legenda do Diagrama:**
- **Classes azuis:** Entidades de dom√≠nio principais
- **Classes verdes:** Services e controllers
- **Classes amarelas:** DAOs e persist√™ncia
- **Setas s√≥lidas:** Associa√ß√µes diretas
- **Setas tracejadas:** Depend√™ncias de uso

**Observa√ß√µes:**
- Diagrama segue padr√µes UML 2.0
- Arquitetura suporta tanto mobile quanto desktop
- Sincroniza√ß√£o √© tratada como concern transversal
- Padr√µes de design aplicados consistentemente

---

*Diagrama criado seguindo padr√µes UML 2.0 e Clean Architecture*  
*Vers√£o: 1.0 | Data: Dezembro 2024*  
*Ferramenta: Mermaid + An√°lise de Arquitetura*